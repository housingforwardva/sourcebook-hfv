<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>SOURCEBOOK - 1&nbsp; Population</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<meta name="shinylive:serviceworker_dir" content=".">
<script src="site_libs/quarto-contrib/shinylive-0.2.3/shinylive/load-shinylive-sw.js" type="module"></script>
<script src="site_libs/quarto-contrib/shinylive-0.2.3/shinylive/run-python-blocks.js" type="module"></script>
<link href="site_libs/quarto-contrib/shinylive-0.2.3/shinylive/shinylive.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/shinylive-quarto-css/shinylive-quarto.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Population</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">SOURCEBOOK</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/housingforwardva/sourcebook-2.0" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">DEMOGRAPHICS</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./population.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Population</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#total-population" id="toc-total-population" class="nav-link active" data-scroll-target="#total-population"><span class="toc-section-number">1.1</span>  Total Population</a></li>
  <li><a href="#components-of-population-change" id="toc-components-of-population-change" class="nav-link" data-scroll-target="#components-of-population-change"><span class="toc-section-number">1.2</span>  Components of Population Change</a>
  <ul class="collapse">
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources"><span class="toc-section-number">1.2.1</span>  Additional resources</a></li>
  </ul></li>
  <li><a href="#data-sources" id="toc-data-sources" class="nav-link" data-scroll-target="#data-sources"><span class="toc-section-number">1.3</span>  Data sources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="population" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Population</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p>The dashboards on this page include data on total population counts and components of population change. These trends help reveal how much, and for what reasons, population levels may be increasing or decreasing over time.</p>
<section id="total-population" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="total-population"><span class="header-section-number">1.1</span> Total Population</h2>
<p>This dashboard shows annual population counts and percent changes from 2010 to 2022. Data for 2010 and 2020 are from those years’ Decennial Census counts; all other years use estimates from the Census Bureau’s Population Estimates Program (PEP).</p>
<pre class="shinylive-r" data-engine="r"><code>#| standalone: true
#| echo: false

# This is a Shiny app that shows the total population
# of Virginia geographies from 2010 to 2022 based on 
# Census Population Estimates Program and the Decennial
# Census.

# Load necessary libraries.

library(shiny)
library(tidyverse)
library(ggplot2)
library(ggiraph)
library(ggtext)
library(glue)
library(hdatools)
library(scales)
library(rsconnect)
library(bslib)

# Load in data that has already been cleaned in R script.
total_pop &lt;- readRDS("data/total_pop.rds")

# Create a list of all unique CBSAs and localities in Virginia based on the data.
cbsa_list &lt;- sort(unique(total_pop$cbsa_title))
locality_list &lt;- sort(unique(total_pop$name_long))

# Aggregate data to the CBSA-level for faster processing.
cbsa_pop &lt;- total_pop |&gt; 
  group_by(year, cbsa_title, counttype) |&gt; 
  summarise(value = sum(value))

# Aggregate data to the state-lvel for faster processing.
state_pop &lt;- total_pop |&gt; 
  group_by(year, counttype) |&gt; 
  summarise(value = sum(value))

# The server in a Shiny app is the "back-end." It is all the work that is being
# done behind the scenes to create the reactive visualization. This is done 
# based on input from a user that then leads to an output.

server &lt;- function(input, output) {
  
  options(shiny.autoreload = TRUE)
  
  locality &lt;- reactive({
    filter(total_pop, name_long == input$sel_locality)
  })
  
  cbsa &lt;- reactive({
    filter(cbsa_pop, cbsa_title == input$sel_cbsa)
  })
  
  output$local_plot &lt;- renderGirafe({
    
    gg &lt;- ggplot(locality(),
                 aes(x = year,
                     y = value,
                     fill = counttype,
                     data_id = value,
                     tooltip = number_format(big.mark = ",")(value))) +
      geom_col(position = "dodge") +
      geom_col_interactive(position = "dodge") +
      # theme_hfv(base_size = 15) +
      # scale_fill_hfv() +
      labs(title = "Local population",
           subtitle = input$sel_locality,
           caption = "**Source:** U.S. Census Bureau, Population Estimates Program and Decennial Census.") +
      scale_y_continuous(labels = number_format(big.mark = ","))
    
    
    girafe(ggobj = gg, 
           width_svg = 7, 
           height_svg = 4,
    options = list(
      opts_tooltip(css = "background-color:white;color:black;font-family:Verdana;padding:5pt;"),
      opts_sizing(rescale = FALSE),
      opts_toolbar(pngname = input$sel_locality)))
})
  
  output$cbsa_plot &lt;- renderGirafe({
    
    gg &lt;- ggplot(cbsa(),
                 aes(x = year,
                     y = value,
                     fill = counttype,
                     data_id = value,
                     tooltip = number_format(big.mark = ",")(value))) +
      geom_col(position = "dodge") +
      geom_col_interactive(position = "dodge") +
      # theme_hfv(base_size = 15) +
      # scale_fill_hfv() +
      labs(title = "Core-based statistical area population",
           subtitle = input$sel_cbsa,
           caption = "**Source:** U.S. Census Bureau, Population Estimates Program and Decennial Census.") +
    scale_y_continuous(labels = number_format(big.mark = ","))
    
    girafe(ggobj = gg, 
           width_svg = 7, 
           height_svg = 4,
           options = list(
             opts_tooltip(css = "background-color:white;color:black;font-family:Verdana;padding:5pt;"),
             opts_sizing(rescale = FALSE),
             opts_toolbar(pngname = input$sel_cbsa)))
  })
  
  output$state_plot &lt;- renderGirafe({
    
    gg &lt;- ggplot(state_pop,
                 aes(x = year,
                     y = value,
                     fill = counttype,
                     data_id = value,
                     tooltip = number_format(big.mark = ",")(value))) +
      geom_col(position = "dodge") +
      geom_col_interactive(position = "dodge") +
      # theme_hfv(base_size = 15) +
      # scale_fill_hfv() +
      labs(title = "Virginia population",
           caption = "**Source:** U.S. Census Bureau, Population Estimates Program and Decennial Census.") +
      scale_y_continuous(labels = number_format(big.mark = ","))
    
    
    girafe(ggobj = gg, 
           width_svg = 7, 
           height_svg = 4,
           options = list(
             opts_tooltip(css = "background-color:white;color:black;font-family:Verdana;padding:5pt;"),
             opts_sizing(rescale = FALSE),
             opts_toolbar(pngname = "state_pop"))) 
  })
}

# The user interface (ui) is the front-facing side of the visualization. It includes 
# the input options, the output, and any other stylization for the visualization.
# 
  ui &lt;- fluidPage(
    tags$head(
    tags$link(rel = "stylesheet", href = "https://fonts.googleapis.com/css?family=FontName", type = "text/css"),
    tags$style(HTML("

      .selectize-input {
        font-size: 10pt;
      }
      
      .selectize-dropdown {
        font-size: 10pt;
      } 
      
      .centered-image-container {
          display: flex;
          justify-content: right;
          align-items: right;
      }

    "))),
    page_sidebar(mainPanel(
      tabsetPanel(type = "tabs", id = "tabselected", selected = 1,
        tabPanel("Statewide", girafeOutput("state_plot"), value =1),
        tabPanel("CBSA", girafeOutput("cbsa_plot"), value =2),
        tabPanel("Locality", girafeOutput("local_plot"), value =3)
      )
    ),
    sidebar = sidebar(
      position = "right",
      conditionalPanel(condition = "input.tabselected==2",
                       selectInput(
                         inputId = "sel_cbsa",
                         label = "Select a CBSA",
                         choices = cbsa_list
                       ),
                       style = "font-family: Open Sans;"
      ),
      conditionalPanel(condition = "input.tabselected==3",
        selectInput(
          inputId = "sel_locality",
          label = "Select a locality",
          choices = locality_list
        ),
        style = "font-family: Open Sans;"
      )
    ),
    hr(),
    div(class = "centered-image-container",
    img(src = "hfv_logo.png", width ="150px"))
  ))


# Run the application 
shinyApp(ui = ui, server = server)

</code></pre>

<iframe id="example1" src="https://housingforwardva.shinyapps.io/total_pop/" style="border: none; width: 700px; height: 550px" frameborder="0"></iframe>

</section>
<section id="components-of-population-change" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="components-of-population-change"><span class="header-section-number">1.2</span> Components of Population Change</h2>
<p>This dashboard breaks down annual population changes by three different components:</p>
<ul>
<li>Natural increases (births minus deaths),</li>
<li>Domestic migration (net moves from in/out of state), and</li>
<li>International migration (net moves from in/out of the country).</li>
</ul>
<div class="cell">

</div>
<section id="additional-resources" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="additional-resources"><span class="header-section-number">1.2.1</span> Additional resources</h3>
<p><strong>U.S. Census Bureau</strong></p>
<p><a href="https://www.census.gov/library/stories/state-by-state/virginia-population-change-between-census-decade.html"><em>Virginia adds more than 600,000 people since 2010</em></a></p>
<p><strong>UVA Weldon Cooper Center</strong></p>
<p><a href="https://news.virginia.edu/content/state-population-growth-slows-most-new-residents-northern-virginia"><em>State population growth slows, with most new residents in Northern Virginia</em></a></p>
<p><a href="https://statchatva.org/2021/09/27/comparing-2020-virginia-population-projections-to-the-census-count/"><em>Comparing 2020 Virginia population projections to the Census count</em></a></p>
</section>
</section>
<section id="data-sources" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="data-sources"><span class="header-section-number">1.3</span> Data sources</h2>
<p><a href="https://www.census.gov/programs-surveys/popest.html">Census Population Estimates Program</a> (PEP)</p>
<p>Annual estimates of total population released by the U.S. Census Bureau. Available at locality level from 2010 to 2019. Estimates by age, race, and ethnicity also available, along with components of population change.</p>
<p><a href="https://www.census.gov/programs-surveys/decennial-census/about/rdo/summary-files.html">2020 Decennial Census</a></p>
<p>Initial data from the 2020 Decennial Census is available in the PL 94-171 Redistricting summary file. As of February 2022, we use this data to append 2020 population counts onto the PEP time series data through 2019. Complete 2010 to 2020 Intercensal Estimates will be published in late 2022.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">About</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>